<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Doctor Note Generator</title>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- Comfortaa font -->
<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root{--bg:#f7f8fb;--card:#fff;--accent:#1f2937;--muted:#6b7280;}
  html,body{margin:0;padding:0;font-family:"Comfortaa",Arial,sans-serif;background:var(--bg);color:#111;}
  .wrap{max-width:600px;margin:30px auto;padding:20px;}
  .card{background:var(--card);padding:20px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
  label{display:block;margin-top:12px;font-weight:700;}
  input[type=text], input[type=date]{width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid #d1d5db;box-sizing:border-box;font-weight:700;}
  button.primary{margin-top:12px;background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:700;}
  pre#output{background:#fafafa;padding:12px;border-radius:8px;border:1px solid #eee;margin-top:14px;white-space:pre-wrap;}
  .login-wrap{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);}
  .login-card{width:360px;background:var(--card);padding:20px;border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,0.2);}
  .login-card h2{text-align:center;margin:0 0 12px;font-size:20px;}
</style>
</head>
<body>

<!-- Login -->
<div id="login" class="login-wrap">
  <div class="login-card">
    <h2>Login</h2>
    <label for="loginUser">Username</label>
    <input id="loginUser" type="text" placeholder="Enter username">
    <label for="loginPass">Password</label>
    <input id="loginPass" type="password" placeholder="Enter password">
    <button id="loginBtn" class="primary">Sign in</button>
  </div>
</div>

<!-- App -->
<div id="app" class="wrap" style="display:none">
  <div class="card">
    <h3>Doctor Note Generator</h3>
    
    <label>Patient Name:</label>
    <input type="text" id="patientName" placeholder="Enter patient name">
    
    <label>Illness:</label>
    <input type="text" id="illness" placeholder="Enter illness">
    
    <label>Start Date (MM-DD-YYYY):</label>
    <input type="text" id="startDate" placeholder="MM-DD-YYYY">
    
    <label>End Date (MM-DD-YYYY):</label>
    <input type="text" id="endDate" placeholder="MM-DD-YYYY">
    
    <label>Return Date (MM-DD-YYYY):</label>
    <input type="text" id="returnDate" placeholder="MM-DD-YYYY">
    
    <label>Provider Name & Credentials:</label>
    <input type="text" id="provider" placeholder="Dr. Nicolas McCarthy MD PhD FACS">
    
    <button id="generateBtn" class="primary">Generate PDF</button>
    
    <pre id="output"></pre>
  </div>
</div>

<script>
const ACCOUNTS = {
  'nmccgsuh': '15358',
  'physician': 'physician'
};

const loginWrap = document.getElementById('login');
const loginUser = document.getElementById('loginUser');
const loginPass = document.getElementById('loginPass');
const loginBtn = document.getElementById('loginBtn');
const app = document.getElementById('app');

loginBtn.addEventListener('click', ()=>{
  const u = (loginUser.value||'').trim();
  const p = (loginPass.value||'').trim();
  if(ACCOUNTS[u] && ACCOUNTS[u] === p){
    loginWrap.style.display='none';
    app.style.display='block';
    if(u==='nmccgsuh') document.getElementById('provider').value = 'Dr. Nicolas McCarthy MD PhD FACS';
  } else {
    alert('Incorrect username or password.');
  }
});

// PDF generation
document.getElementById('generateBtn').addEventListener('click', ()=>{
  const name = document.getElementById('patientName').value || "[Name]";
  const illness = document.getElementById('illness').value || "[Illness]";
  const start = document.getElementById('startDate').value || "[Start Date]";
  const end = document.getElementById('endDate').value || "[End Date]";
  const ret = document.getElementById('returnDate').value || "[Return Date]";
  const provider = document.getElementById('provider').value || "Dr. [Name]";

  const noteText = `I, ${provider}, am writing this note to inform you that I have seen ${name} in my hospital on the day of ${start}.\n\nTesting revealed ${name} has ${illness} and as ${name}'s healthcare provider I am recommending for ${name} to be excused from SCHOOL/WORK from the dates of ${start} - ${end} allowing ${name} to return on ${ret}.\n\nIf you require any additional information do not hesitate to contact me at (631) 379-7125. Thank you for understanding.\n\nSincerely,\n${provider}`;

  document.getElementById('output').textContent = noteText;

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(12);
  let y = 12;
  const lineHeight = 7;
  const leftMargin = 12;

  noteText.split("\n").forEach(line=>{
    const wrapped = doc.splitTextToSize(line, 180);
    doc.text(wrapped, leftMargin, y);
    y += lineHeight*wrapped.length;
    if(y>280){ doc.addPage(); y=12; }
  });

  doc.save(`${name.replace(/[^a-z0-9]/gi,'_')}_DoctorNote.pdf`);
});
</script>

</body>
</html>
